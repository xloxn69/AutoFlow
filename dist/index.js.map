{"version":3,"sources":["../src/index.ts","../src/core/permission-mappings.ts","../src/core/validator.ts","../src/core/pack-aggregator.ts","../src/react/hooks.ts"],"sourcesContent":["/**\n * @automater/autoflow\n *\n * Real-time workflow validation system for Automater\n *\n * @example Core usage (Node.js, browser, Deno)\n * ```ts\n * import { AutoFlowValidator } from '@automater/autoflow/core'\n *\n * const validator = new AutoFlowValidator()\n * const result = await validator.validateWorkflow(workflow)\n * ```\n *\n * @example React integration (with ReactFlow)\n * ```tsx\n * import { useWorkflowLinting } from '@automater/autoflow/react'\n *\n * const lintingState = useWorkflowLinting(nodes, edges)\n * ```\n */\n\n// Core exports (pure TypeScript)\nexport {\n  AutoFlowValidator,\n  AutomaterLinter,\n  DEFAULT_LINT_CONFIG,\n  type AutomaterWorkflow,\n  type WorkflowTrigger,\n  type WorkflowNode,\n  type VariableDefinition,\n  type LintIssue,\n  type WorkflowLintResult,\n  type LintConfig,\n} from './core/validator'\n\nexport {\n  PackPermissionAggregator,\n  type AutomaterPack,\n  type PermissionSummary,\n  ACTION_PERMISSION_MAPPINGS,\n  TRIGGER_PERMISSION_MAPPINGS,\n  PERMISSION_SEVERITY,\n  PERMISSION_DESCRIPTIONS,\n  hasActionPermissionMapping,\n  hasTriggerPermissionMapping,\n  getPermissionSeverity,\n  getPermissionDescription,\n} from './core'\n\n// React exports (requires React + ReactFlow)\nexport {\n  useWorkflowLinting,\n  useNodeLinting,\n  useEdgeLinting,\n  useGroupedIssues,\n  createWorkflowFromReactFlow,\n  type UseWorkflowLintingOptions,\n  type WorkflowLintingState,\n} from './react/hooks'\n","/**\n * Action-to-Permission Mapping Registry\n *\n * This file serves as the SINGLE SOURCE OF TRUTH for automatic permission detection\n * in the AutoFlow workflow validation system. Each action type is mapped to the\n * Discord permissions required to execute that action.\n *\n * Based on Discord.js PermissionFlagsBits and Discord API documentation.\n * See: https://discord.com/developers/docs/topics/permissions\n *\n * @module permission-mappings\n * @packageDocumentation\n */\n\n/**\n * Maps AutoFlow action types to required Discord permission flags\n *\n * Permission flags correspond to Discord.js PermissionFlagsBits:\n * - SEND_MESSAGES, VIEW_CHANNEL, MANAGE_MESSAGES, etc.\n *\n * Empty arrays [] indicate no Discord permissions required (e.g., database operations)\n */\nexport const ACTION_PERMISSION_MAPPINGS: Record<string, string[]> = {\n  // ============================================================================\n  // MESSAGING ACTIONS\n  // ============================================================================\n\n  /**\n   * Send Message - Sends a message to a specified channel\n   * Required: SEND_MESSAGES (send), VIEW_CHANNEL (see channel)\n   */\n  'send_message': ['SEND_MESSAGES', 'VIEW_CHANNEL'],\n\n  /**\n   * Edit Message - Edits a bot's own message\n   * Required: SEND_MESSAGES (implies edit own messages), VIEW_CHANNEL\n   */\n  'edit_message': ['SEND_MESSAGES', 'VIEW_CHANNEL'],\n\n  /**\n   * Send Direct Message - Sends a DM to a user\n   * Required: None (DMs don't require guild permissions)\n   */\n  'send_direct_message': [],\n\n  /**\n   * Delete Message - Deletes any message (including others' messages)\n   * Required: MANAGE_MESSAGES (delete others' messages), VIEW_CHANNEL\n   */\n  'delete_message': ['MANAGE_MESSAGES', 'VIEW_CHANNEL'],\n\n  /**\n   * Log Event - Logs an event in a specified channel (sends message)\n   * Required: SEND_MESSAGES, VIEW_CHANNEL\n   */\n  'log_event': ['SEND_MESSAGES', 'VIEW_CHANNEL'],\n\n  // ============================================================================\n  // USER MANAGEMENT ACTIONS\n  // ============================================================================\n\n  /**\n   * Add Role - Adds a role to a user\n   * Required: MANAGE_ROLES (role management)\n   * Note: Bot's highest role must be above target role\n   */\n  'add_role': ['MANAGE_ROLES'],\n\n  /**\n   * Remove Role - Removes a role from a user\n   * Required: MANAGE_ROLES (role management)\n   * Note: Bot's highest role must be above target role\n   */\n  'remove_role': ['MANAGE_ROLES'],\n\n  /**\n   * Change Nickname - Changes a user's nickname\n   * Required: MANAGE_NICKNAMES (change others' nicknames)\n   */\n  'change_nickname': ['MANAGE_NICKNAMES'],\n\n  // ============================================================================\n  // MODERATION ACTIONS\n  // ============================================================================\n\n  /**\n   * Kick User - Kicks a user from the server\n   * Required: KICK_MEMBERS (kick permission)\n   * Note: Bot's highest role must be above target user\n   */\n  'kick_user': ['KICK_MEMBERS'],\n\n  /**\n   * Ban User - Bans a user from the server\n   * Required: BAN_MEMBERS (ban permission)\n   * Note: Bot's highest role must be above target user\n   */\n  'ban_user': ['BAN_MEMBERS'],\n\n  /**\n   * Unban User - Unbans a user from the server\n   * Required: BAN_MEMBERS (same permission as ban)\n   */\n  'unban_user': ['BAN_MEMBERS'],\n\n  /**\n   * Mute User - Times out a user (Discord timeout feature)\n   * Required: MODERATE_MEMBERS (timeout permission)\n   * Note: Bot's highest role must be above target user\n   */\n  'mute_user': ['MODERATE_MEMBERS'],\n\n  /**\n   * Unmute User - Removes timeout from a user\n   * Required: MODERATE_MEMBERS (timeout permission)\n   */\n  'unmute_user': ['MODERATE_MEMBERS'],\n\n  // ============================================================================\n  // CHANNEL MANAGEMENT ACTIONS\n  // ============================================================================\n\n  /**\n   * Create Channel - Creates a new text/voice/category channel\n   * Required: MANAGE_CHANNELS (create/edit channels)\n   */\n  'create_channel': ['MANAGE_CHANNELS'],\n\n  /**\n   * Delete Channel - Deletes a channel\n   * Required: MANAGE_CHANNELS (delete channels)\n   */\n  'delete_channel': ['MANAGE_CHANNELS'],\n\n  /**\n   * Create Category - Creates a new category\n   * Required: MANAGE_CHANNELS (create/edit channels)\n   */\n  'create_category': ['MANAGE_CHANNELS'],\n\n  /**\n   * Modify Channel - Modifies channel properties (name, topic, slowmode, etc.)\n   * Required: MANAGE_CHANNELS (edit channels)\n   */\n  'modify_channel': ['MANAGE_CHANNELS'],\n\n  // ============================================================================\n  // REACTION & INTERACTION ACTIONS\n  // ============================================================================\n\n  /**\n   * Add Reaction - Adds a reaction emoji to a message\n   * Required: ADD_REACTIONS (add reactions), VIEW_CHANNEL (see message)\n   */\n  'add_reaction': ['ADD_REACTIONS', 'VIEW_CHANNEL'],\n\n  /**\n   * Remove Reaction - Removes a reaction from a message (any user's reaction)\n   * Required: MANAGE_MESSAGES (remove others' reactions), VIEW_CHANNEL\n   */\n  'remove_reaction': ['MANAGE_MESSAGES', 'VIEW_CHANNEL'],\n\n  /**\n   * Pin Message - Pins a message in a channel\n   * Required: MANAGE_MESSAGES (pin/unpin messages), VIEW_CHANNEL\n   */\n  'pin_message': ['MANAGE_MESSAGES', 'VIEW_CHANNEL'],\n\n  /**\n   * Unpin Message - Unpins a message in a channel\n   * Required: MANAGE_MESSAGES (pin/unpin messages), VIEW_CHANNEL\n   */\n  'unpin_message': ['MANAGE_MESSAGES', 'VIEW_CHANNEL'],\n\n  // ============================================================================\n  // DATA MANAGEMENT ACTIONS (No Discord permissions needed)\n  // ============================================================================\n\n  /**\n   * Variable Update - Updates a workflow variable value\n   * Required: None (internal data operation)\n   */\n  'variable_update': [],\n\n  /**\n   * Database Insert - Inserts data into ForgeDB\n   * Required: None (internal database operation)\n   */\n  'database_insert': [],\n\n  /**\n   * Database Query - Queries data from ForgeDB\n   * Required: None (internal database operation)\n   */\n  'database_query': [],\n\n  // ============================================================================\n  // EXTERNAL INTEGRATION ACTIONS\n  // ============================================================================\n\n  /**\n   * Webhook Send - Sends data to a Discord webhook\n   * Required: MANAGE_WEBHOOKS (create/manage webhooks)\n   */\n  'webhook_send': ['MANAGE_WEBHOOKS'],\n\n  /**\n   * HTTP Request - Makes HTTP requests to external APIs\n   * Required: None (external API, not Discord)\n   */\n  'http_request': [],\n\n  /**\n   * Create Invite - Creates a server invite link\n   * Required: CREATE_INSTANT_INVITE (create invites)\n   */\n  'create_invite': ['CREATE_INSTANT_INVITE'],\n};\n\n/**\n * Maps AutoFlow trigger types to required Discord permissions for event listening\n *\n * Most triggers are passive (no permissions needed to listen), but some require\n * permissions to access the event data properly.\n *\n * Note: These are permissions needed to LISTEN to events, not to trigger them.\n */\nexport const TRIGGER_PERMISSION_MAPPINGS: Record<string, string[]> = {\n  // ============================================================================\n  // USER MANAGEMENT TRIGGERS (Passive - no permissions needed)\n  // ============================================================================\n\n  'user_join': [],\n  'user_leave': [],\n  'user_ban': [],\n  'user_kick': [],\n  'user_update': [],\n\n  // ============================================================================\n  // MESSAGE SYSTEM TRIGGERS\n  // ============================================================================\n\n  /**\n   * Send Message (Message Create) - Bot receives message events\n   * Required: VIEW_CHANNEL (see messages in channel)\n   */\n  'send_message': ['VIEW_CHANNEL'],\n\n  /**\n   * Message Delete - Bot receives message delete events\n   * Required: VIEW_CHANNEL (see channel where deletion occurred)\n   */\n  'message_delete': ['VIEW_CHANNEL'],\n\n  /**\n   * Message Edit - Bot receives message edit events\n   * Required: VIEW_CHANNEL (see channel where edit occurred)\n   */\n  'message_edit': ['VIEW_CHANNEL'],\n\n  // ============================================================================\n  // CHANNEL MANAGEMENT TRIGGERS (Passive - no permissions needed)\n  // ============================================================================\n\n  'channel_create': [],\n  'channel_delete': [],\n\n  // ============================================================================\n  // ROLE MANAGEMENT TRIGGERS (Passive - no permissions needed)\n  // ============================================================================\n\n  'role_create': [],\n  'role_delete': [],\n  'role_add': [],\n  'role_remove': [],\n\n  // ============================================================================\n  // REACTION SYSTEM TRIGGERS\n  // ============================================================================\n\n  /**\n   * Reaction Add - Bot receives reaction add events\n   * Required: VIEW_CHANNEL (see reactions on messages)\n   */\n  'reaction_add': ['VIEW_CHANNEL'],\n\n  /**\n   * Reaction Remove - Bot receives reaction remove events\n   * Required: VIEW_CHANNEL (see reactions on messages)\n   */\n  'reaction_remove': ['VIEW_CHANNEL'],\n\n  // ============================================================================\n  // VOICE SYSTEM TRIGGERS\n  // ============================================================================\n\n  /**\n   * Voice Channel Join - Bot tracks voice channel joins\n   * Required: VIEW_CHANNEL (see voice channel) + CONNECT (track voice state)\n   */\n  'voice_channel_join': ['VIEW_CHANNEL', 'CONNECT'],\n\n  /**\n   * Voice Channel Leave - Bot tracks voice channel leaves\n   * Required: VIEW_CHANNEL (see voice channel) + CONNECT (track voice state)\n   */\n  'voice_channel_leave': ['VIEW_CHANNEL', 'CONNECT'],\n\n  // ============================================================================\n  // SERVER MANAGEMENT TRIGGERS (Passive - no permissions needed)\n  // ============================================================================\n\n  'server_update': [],\n\n  // ============================================================================\n  // COMMAND SYSTEM TRIGGERS (Passive - permissions checked at execution time)\n  // ============================================================================\n\n  'slash_command': [],\n  'prefixed_command': [],\n};\n\n/**\n * Permission severity classification for UI display\n *\n * - DANGEROUS: Can cause severe damage (ban, kick, manage guild, administrator)\n * - MODERATE: Significant impact (manage messages, channels, roles, nicknames)\n * - SAFE: Minimal impact (send messages, add reactions, view channels)\n */\nexport const PERMISSION_SEVERITY: Record<string, 'safe' | 'moderate' | 'dangerous'> = {\n  // DANGEROUS - Severe impact\n  'ADMINISTRATOR': 'dangerous',\n  'BAN_MEMBERS': 'dangerous',\n  'KICK_MEMBERS': 'dangerous',\n  'MANAGE_GUILD': 'dangerous',\n  'MANAGE_ROLES': 'dangerous',\n  'MANAGE_WEBHOOKS': 'dangerous',\n  'MODERATE_MEMBERS': 'dangerous',\n\n  // MODERATE - Significant impact\n  'MANAGE_CHANNELS': 'moderate',\n  'MANAGE_MESSAGES': 'moderate',\n  'MANAGE_NICKNAMES': 'moderate',\n  'MANAGE_THREADS': 'moderate',\n  'MANAGE_EVENTS': 'moderate',\n  'MANAGE_EMOJIS_AND_STICKERS': 'moderate',\n\n  // SAFE - Minimal impact\n  'SEND_MESSAGES': 'safe',\n  'VIEW_CHANNEL': 'safe',\n  'ADD_REACTIONS': 'safe',\n  'CREATE_INSTANT_INVITE': 'safe',\n  'READ_MESSAGE_HISTORY': 'safe',\n  'SEND_MESSAGES_IN_THREADS': 'safe',\n  'EMBED_LINKS': 'safe',\n  'ATTACH_FILES': 'safe',\n  'USE_EXTERNAL_EMOJIS': 'safe',\n  'USE_EXTERNAL_STICKERS': 'safe',\n  'CONNECT': 'safe',\n  'SPEAK': 'safe',\n  'STREAM': 'safe',\n  'USE_VAD': 'safe',\n  'CHANGE_NICKNAME': 'safe',\n  'USE_APPLICATION_COMMANDS': 'safe',\n};\n\n/**\n * Human-readable descriptions for Discord permissions\n * Source: Discord Developer Documentation\n */\nexport const PERMISSION_DESCRIPTIONS: Record<string, string> = {\n  'SEND_MESSAGES': 'Allows sending messages in text channels',\n  'VIEW_CHANNEL': 'Allows viewing channels and reading message history',\n  'MANAGE_MESSAGES': 'Allows deleting messages from other users and pinning messages',\n  'MANAGE_ROLES': 'Allows creating, editing, and deleting roles below bot\\'s highest role',\n  'BAN_MEMBERS': 'Allows banning and unbanning members',\n  'KICK_MEMBERS': 'Allows kicking members from the server',\n  'MANAGE_CHANNELS': 'Allows creating, editing, and deleting channels',\n  'MANAGE_NICKNAMES': 'Allows changing other members\\' nicknames',\n  'MODERATE_MEMBERS': 'Allows timing out members to prevent them from sending messages',\n  'ADD_REACTIONS': 'Allows adding reactions to messages',\n  'MANAGE_WEBHOOKS': 'Allows creating, editing, and deleting webhooks',\n  'CREATE_INSTANT_INVITE': 'Allows creating instant invites to the server',\n  'ADMINISTRATOR': 'Grants all permissions and bypasses channel permission overwrites',\n  'MANAGE_GUILD': 'Allows managing server settings and configurations',\n  'CONNECT': 'Allows joining voice channels',\n  'SPEAK': 'Allows speaking in voice channels',\n  'MANAGE_THREADS': 'Allows managing threads (archive, delete, view private threads)',\n  'MANAGE_EVENTS': 'Allows creating, editing, and deleting server events',\n  'MANAGE_EMOJIS_AND_STICKERS': 'Allows managing custom emojis and stickers',\n};\n\n/**\n * Type guard to check if an action type has a permission mapping\n */\nexport function hasActionPermissionMapping(action: string): boolean {\n  return action in ACTION_PERMISSION_MAPPINGS;\n}\n\n/**\n * Type guard to check if a trigger type has a permission mapping\n */\nexport function hasTriggerPermissionMapping(trigger: string): boolean {\n  return trigger in TRIGGER_PERMISSION_MAPPINGS;\n}\n\n/**\n * Get permission severity level for UI display\n */\nexport function getPermissionSeverity(permission: string): 'safe' | 'moderate' | 'dangerous' {\n  return PERMISSION_SEVERITY[permission] || 'safe';\n}\n\n/**\n * Get human-readable description for a permission\n */\nexport function getPermissionDescription(permission: string): string {\n  return PERMISSION_DESCRIPTIONS[permission] || `Discord permission: ${permission}`;\n}\n","/**\n * AutoFlow Core Validator\n *\n * Pure TypeScript workflow validation engine with zero React dependencies\n * Can run in Node.js, browser, Deno, or any JavaScript runtime\n */\n\nimport {\n  ACTION_PERMISSION_MAPPINGS,\n  TRIGGER_PERMISSION_MAPPINGS,\n  hasActionPermissionMapping,\n  hasTriggerPermissionMapping\n} from './permission-mappings'\n\n// Core workflow interfaces\nexport interface AutomaterWorkflow {\n  id: string\n  name: string\n  description?: string\n  icon?: string\n  color?: string\n  version: string\n  category?: string\n  tags?: string[]\n  trigger: WorkflowTrigger\n  nodes: WorkflowNode[]\n  permissions?: string[]\n  variables?: VariableDefinition[]\n  visibility?: 'public' | 'private' | 'unlisted'\n  createdAt?: string\n  updatedAt?: string\n}\n\nexport interface WorkflowTrigger {\n  type: 'event' | 'slash_command' | 'prefixed_command' | 'schedule'\n  event?: string\n  command?: string\n  prefix?: string\n  schedule?: string\n}\n\nexport interface WorkflowNode {\n  id: string\n  type: 'trigger' | 'action' | 'condition' | 'transformer' | 'end'\n  action?: string\n  params?: Record<string, unknown>\n  connections?: string[]\n  onError?: string\n  weight?: number\n  permissions?: string[]\n}\n\nexport interface VariableDefinition {\n  name: string\n  type: 'guild' | 'member' | 'custom'\n  scope: 'guild' | 'global'\n  description?: string\n  default?: unknown\n}\n\n// Lint result interfaces\nexport interface LintIssue {\n  id: string\n  ruleId: string\n  errorCode: string\n  family: 'AUT' | 'SYS'\n  severity: 'info' | 'warn' | 'error' | 'critical'\n  message: string\n  remediation: string\n  devHint?: string\n  location?: {\n    nodeId?: string\n    edgeId?: string\n    path?: string\n    line?: number\n    column?: number\n  }\n  context?: Record<string, unknown>\n  fixable?: boolean\n  suggestions?: string[]\n  timestamp?: number\n}\n\nexport interface WorkflowLintResult {\n  workflowId: string\n  isValid: boolean\n  summary: {\n    total: number\n    errors: number\n    warnings: number\n    infos: number\n    criticals: number\n  }\n  issues: LintIssue[]\n  errors: LintIssue[]\n  warnings: LintIssue[]\n  infos: LintIssue[]\n  criticals: LintIssue[]\n  fixableCount: number\n  timestamp: number\n  performance: {\n    analysisTime: number\n    rulesExecuted: number\n  }\n}\n\nexport interface LintConfig {\n  rules: Record<string, 'off' | 'warn' | 'error'>\n  settings?: {\n    rateLimits?: {\n      maxWorkflowWeight: number\n      maxNodeWeight: number\n      warnThreshold: number\n    }\n    naming?: {\n      workflowIdPattern: string\n      nodeIdPattern: string\n      variableNamePattern: string\n    }\n  }\n}\n\n// Default configuration\nexport const DEFAULT_LINT_CONFIG: LintConfig = {\n  rules: {\n    // Schema validation rules\n    'schema/required-fields': 'error',\n    'schema/field-types': 'error',\n    'schema/semver': 'error',\n    'schema/enum-values': 'error',\n\n    // Graph integrity rules\n    'graph/missing-nodes': 'error',\n    'graph/entry-points': 'error',\n    'graph/unreachable-nodes': 'warn',\n    'graph/infinite-loops': 'error',\n    'graph/dead-ends': 'warn',\n\n    // Variable and template rules\n    'variable/undefined-reference': 'error',\n    'variable/invalid-interpolation': 'error',\n    'variable/scope-mismatch': 'warn',\n    'variable/naming-convention': 'warn',\n\n    // Trigger and action rules\n    'trigger/unknown-event': 'error',\n    'trigger/invalid-command': 'error',\n    'action/unknown-type': 'error',\n    'action/missing-params': 'error',\n\n    // Security rules\n    'security/missing-permissions': 'error',\n    'security/excessive-permissions': 'warn',\n    'security/hardcoded-secrets': 'error',\n    'security/pii-exposure': 'warn',\n\n    // Performance rules\n    'perf/missing-weight': 'warn',\n    'perf/high-weight': 'warn',\n    'perf/deep-nesting': 'warn',\n    'perf/large-workflow': 'warn',\n\n    // Style rules\n    'style/naming-convention': 'warn',\n    'style/description-required': 'warn',\n    'style/icon-color-consistency': 'warn',\n    'style/deprecated-features': 'warn'\n  },\n  settings: {\n    rateLimits: {\n      maxWorkflowWeight: 1000,\n      maxNodeWeight: 100,\n      warnThreshold: 0.8\n    },\n    naming: {\n      workflowIdPattern: '^automation-[A-Za-z0-9]{15}$',\n      nodeIdPattern: '^[a-zA-Z][a-zA-Z0-9_-]*$',\n      variableNamePattern: '^[a-zA-Z][a-zA-Z0-9_]*$'\n    }\n  }\n}\n\n// Error catalog - AUT and SYS families\nconst ERROR_CATALOG = {\n  // AUT family - 3xxx range (Missing/Invalid Resources)\n  3310: {\n    family: 'AUT' as const,\n    key: 'AUT_WORKFLOW_UNREACHABLE_NODES',\n    severity: 'warn' as const,\n    message: 'Workflow contains unreachable nodes',\n    remediation: 'Remove unreachable nodes or add connections to make them reachable'\n  },\n  3311: {\n    family: 'AUT' as const,\n    key: 'AUT_NODE_MISSING_CONNECTIONS',\n    severity: 'error' as const,\n    message: 'Node is missing required connections',\n    remediation: 'Add connections array to node or connect to valid target nodes'\n  },\n  3312: {\n    family: 'AUT' as const,\n    key: 'AUT_VARIABLE_INVALID_INTERPOLATION',\n    severity: 'error' as const,\n    message: 'Invalid variable interpolation syntax',\n    remediation: 'Use correct syntax: {variable.name} or {member.displayName}'\n  },\n  3313: {\n    family: 'AUT' as const,\n    key: 'AUT_ICON_NOT_APPROVED',\n    severity: 'warn' as const,\n    message: 'Icon is not in the approved icon catalog',\n    remediation: 'Choose from approved icons in Icon System PRD'\n  },\n\n  // AUT family - 4xxx range (Policy Limits)\n  4120: {\n    family: 'AUT' as const,\n    key: 'AUT_RATE_LIMIT_HIGH_WEIGHT',\n    severity: 'warn' as const,\n    message: 'Workflow weight may cause rate limiting',\n    remediation: 'Reduce node weight or optimize workflow to use fewer resources'\n  },\n  4121: {\n    family: 'AUT' as const,\n    key: 'AUT_NODE_MISSING_WEIGHT',\n    severity: 'warn' as const,\n    message: 'Action node missing rate limit weight',\n    remediation: 'Add weight property to action node for accurate rate limiting'\n  },\n\n  // SYS family - 5xxx range (Platform & External Failures)\n  5510: {\n    family: 'SYS' as const,\n    key: 'SYS_WORKFLOW_PARSE_ERROR',\n    severity: 'error' as const,\n    message: 'Unable to parse workflow file',\n    remediation: 'Check JSON syntax and workflow structure'\n  },\n  5511: {\n    family: 'SYS' as const,\n    key: 'SYS_SCHEMA_VALIDATION_FAILED',\n    severity: 'error' as const,\n    message: 'Workflow schema validation failed',\n    remediation: 'Fix schema violations listed in validation errors'\n  }\n} as const\n\n/**\n * Main AutoFlow validator class\n * Pure TypeScript - no React dependencies\n */\nexport class AutoFlowValidator {\n  private config: LintConfig\n  private nextIssueId = 1\n\n  constructor(config: Partial<LintConfig> = {}) {\n    this.config = {\n      ...DEFAULT_LINT_CONFIG,\n      ...config,\n      rules: {\n        ...DEFAULT_LINT_CONFIG.rules,\n        ...config.rules\n      },\n      settings: {\n        ...DEFAULT_LINT_CONFIG.settings,\n        ...config.settings\n      }\n    }\n  }\n\n  /**\n   * Main validation method - analyzes a complete workflow\n   */\n  async validateWorkflow(workflow: Partial<AutomaterWorkflow>): Promise<WorkflowLintResult> {\n    const startTime = Date.now()\n    const issues: LintIssue[] = []\n    let rulesExecuted = 0\n\n    try {\n      // 1. Basic structure validation\n      const structureIssues = this.validateWorkflowStructure(workflow)\n      issues.push(...structureIssues)\n      rulesExecuted += 4\n\n      // 2. Graph integrity validation (only if we have nodes)\n      if (workflow.nodes && workflow.nodes.length > 0) {\n        const graphIssues = this.validateGraphIntegrity(workflow.nodes)\n        issues.push(...graphIssues)\n        rulesExecuted += 5\n      }\n\n      // 3. Node-specific validation\n      if (workflow.nodes) {\n        const nodeIssues = this.validateNodes(workflow.nodes)\n        issues.push(...nodeIssues)\n        rulesExecuted += workflow.nodes.length * 3\n      }\n\n      // 4. Variable validation\n      if (workflow.variables) {\n        const variableIssues = this.validateVariables(workflow.variables, workflow)\n        issues.push(...variableIssues)\n        rulesExecuted += workflow.variables.length * 2\n      }\n\n      // 5. Performance analysis\n      const performanceIssues = this.validatePerformance(workflow)\n      issues.push(...performanceIssues)\n      rulesExecuted += 3\n\n      // 6. Automatic permission detection\n      if (workflow.trigger && workflow.nodes) {\n        const permissionIssues = this.detectAndValidatePermissions(workflow as AutomaterWorkflow)\n        issues.push(...permissionIssues)\n        rulesExecuted += 1\n      }\n\n      // Filter issues based on configuration\n      const filteredIssues = this.filterIssues(issues)\n\n      // Categorize issues\n      const errors = filteredIssues.filter(i => i.severity === 'error')\n      const warnings = filteredIssues.filter(i => i.severity === 'warn')\n      const infos = filteredIssues.filter(i => i.severity === 'info')\n      const criticals = filteredIssues.filter(i => i.severity === 'critical')\n\n      return {\n        workflowId: workflow.id || 'unknown',\n        isValid: errors.length === 0 && criticals.length === 0,\n        summary: {\n          total: filteredIssues.length,\n          errors: errors.length,\n          warnings: warnings.length,\n          infos: infos.length,\n          criticals: criticals.length\n        },\n        issues: filteredIssues,\n        errors,\n        warnings,\n        infos,\n        criticals,\n        fixableCount: filteredIssues.filter(i => i.fixable).length,\n        timestamp: Date.now(),\n        performance: {\n          analysisTime: Date.now() - startTime,\n          rulesExecuted\n        }\n      }\n\n    } catch (error) {\n      return {\n        workflowId: workflow.id || 'unknown',\n        isValid: false,\n        summary: { total: 1, errors: 1, warnings: 0, infos: 0, criticals: 0 },\n        issues: [this.createSystemError(error)],\n        errors: [this.createSystemError(error)],\n        warnings: [],\n        infos: [],\n        criticals: [],\n        fixableCount: 0,\n        timestamp: Date.now(),\n        performance: {\n          analysisTime: Date.now() - startTime,\n          rulesExecuted\n        }\n      }\n    }\n  }\n\n  /**\n   * Quick validation for minimal node structure\n   * Accepts any object with id, type, action, params, connections, weight\n   */\n  validateNodes(nodes: Array<{\n    id: string\n    type?: string\n    action?: string\n    params?: Record<string, unknown>\n    connections?: string[]\n    weight?: number\n  }>): LintIssue[] {\n    const issues: LintIssue[] = []\n\n    // Convert minimal nodes to WorkflowNode format\n    const workflowNodes: WorkflowNode[] = nodes.map(node => ({\n      id: node.id,\n      type: (node.type || 'action') as WorkflowNode['type'],\n      action: node.action,\n      params: node.params,\n      connections: node.connections || [],\n      weight: node.weight\n    }))\n\n    // Basic graph validation\n    const graphIssues = this.validateGraphIntegrity(workflowNodes)\n    issues.push(...graphIssues)\n\n    const nodeIssues = this.validateNodeList(workflowNodes)\n    issues.push(...nodeIssues)\n\n    return this.filterIssues(issues)\n  }\n\n  // Validation methods\n  private validateWorkflowStructure(workflow: Partial<AutomaterWorkflow>): LintIssue[] {\n    const issues: LintIssue[] = []\n\n    // Required fields validation\n    if (!this.isRuleEnabled('schema/required-fields')) return issues\n\n    const requiredFields: (keyof AutomaterWorkflow)[] = ['id', 'name', 'version', 'trigger']\n\n    for (const field of requiredFields) {\n      if (!workflow[field]) {\n        issues.push(this.createIssue('schema/required-fields', 5511, {\n          message: `Required field '${field}' is missing`,\n          location: { path: field }\n        }))\n      }\n    }\n\n    // Version format validation\n    if (workflow.version && this.isRuleEnabled('schema/semver')) {\n      const semverPattern = /^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-[0-9A-Za-z.-]+)?(?:\\+[0-9A-Za-z.-]+)?$/\n      if (!semverPattern.test(workflow.version)) {\n        issues.push(this.createIssue('schema/semver', 5511, {\n          message: 'Version must be valid SemVer (e.g., 1.2.3)',\n          location: { path: 'version' }\n        }))\n      }\n    }\n\n    return issues\n  }\n\n  private validateGraphIntegrity(nodes: WorkflowNode[]): LintIssue[] {\n    const issues: LintIssue[] = []\n\n    if (!nodes || nodes.length === 0) return issues\n\n    // Build adjacency lists\n    const nodeIds = new Set(nodes.map(n => n.id))\n    const adjacencyList = new Map<string, string[]>()\n    const reverseAdjacencyList = new Map<string, string[]>()\n\n    // Initialize\n    for (const node of nodes) {\n      adjacencyList.set(node.id, [])\n      reverseAdjacencyList.set(node.id, [])\n    }\n\n    // Build connections\n    for (const node of nodes) {\n      const connections = node.connections || []\n      for (const targetId of connections) {\n        // Check for missing nodes\n        if (!nodeIds.has(targetId) && this.isRuleEnabled('graph/missing-nodes')) {\n          issues.push(this.createIssue('graph/missing-nodes', 3311, {\n            message: `Node '${node.id}' connects to non-existent node '${targetId}'`,\n            location: { nodeId: node.id }\n          }))\n          continue\n        }\n\n        adjacencyList.get(node.id)?.push(targetId)\n        reverseAdjacencyList.get(targetId)?.push(node.id)\n      }\n    }\n\n    // Find entry points (trigger nodes or nodes with no incoming connections)\n    const entryNodes = nodes.filter(node =>\n      node.type === 'trigger' ||\n      (reverseAdjacencyList.get(node.id)?.length || 0) === 0\n    )\n\n    // Validate entry points\n    if (this.isRuleEnabled('graph/entry-points')) {\n      if (entryNodes.length === 0) {\n        issues.push(this.createIssue('graph/entry-points', 3311, {\n          message: 'Workflow must have at least one entry point (trigger node)',\n          location: { path: 'nodes' }\n        }))\n      }\n    }\n\n    // Find unreachable nodes\n    if (this.isRuleEnabled('graph/unreachable-nodes')) {\n      const reachable = new Set<string>()\n\n      const dfs = (nodeId: string): void => {\n        if (reachable.has(nodeId)) return\n        reachable.add(nodeId)\n\n        for (const connected of adjacencyList.get(nodeId) || []) {\n          dfs(connected)\n        }\n      }\n\n      entryNodes.forEach(node => dfs(node.id))\n\n      const unreachableNodes = nodes.filter(node => !reachable.has(node.id))\n      for (const node of unreachableNodes) {\n        issues.push(this.createIssue('graph/unreachable-nodes', 3310, {\n          message: `Node '${node.id}' is unreachable from entry points`,\n          location: { nodeId: node.id }\n        }))\n      }\n    }\n\n    return issues\n  }\n\n  private validateNodeList(nodes: WorkflowNode[]): LintIssue[] {\n    const issues: LintIssue[] = []\n\n    for (const node of nodes) {\n      // Action type validation\n      if (node.type === 'action' && this.isRuleEnabled('action/unknown-type')) {\n        if (!node.action) {\n          issues.push(this.createIssue('action/missing-params', 3311, {\n            message: `Action node '${node.id}' is missing action type`,\n            location: { nodeId: node.id }\n          }))\n        }\n      }\n\n      // Weight validation for performance\n      if (node.type === 'action' && this.isRuleEnabled('perf/missing-weight')) {\n        if (typeof node.weight !== 'number') {\n          issues.push(this.createIssue('perf/missing-weight', 4121, {\n            message: `Action node '${node.id}' is missing rate limit weight`,\n            location: { nodeId: node.id },\n            suggestions: ['Add weight property (typical values: 5-30)']\n          }))\n        }\n      }\n\n      // High weight warning\n      if (typeof node.weight === 'number' && this.isRuleEnabled('perf/high-weight')) {\n        const maxWeight = this.config.settings?.rateLimits?.maxNodeWeight || 100\n        if (node.weight > maxWeight) {\n          issues.push(this.createIssue('perf/high-weight', 4120, {\n            message: `Node '${node.id}' weight (${node.weight}) exceeds recommended maximum (${maxWeight})`,\n            location: { nodeId: node.id }\n          }))\n        }\n      }\n    }\n\n    return issues\n  }\n\n  private validateVariables(variables: VariableDefinition[], workflow: Partial<AutomaterWorkflow>): LintIssue[] {\n    const issues: LintIssue[] = []\n\n    if (!this.isRuleEnabled('variable/naming-convention')) return issues\n\n    const pattern = this.config.settings?.naming?.variableNamePattern || '^[a-zA-Z][a-zA-Z0-9_]*$'\n    const regex = new RegExp(pattern)\n\n    for (const variable of variables) {\n      if (!regex.test(variable.name)) {\n        issues.push(this.createIssue('variable/naming-convention', 3312, {\n          message: `Variable name '${variable.name}' doesn't follow naming convention`,\n          location: { path: `variables.${variable.name}` },\n          suggestions: ['Use camelCase or snake_case naming']\n        }))\n      }\n    }\n\n    return issues\n  }\n\n  private validatePerformance(workflow: Partial<AutomaterWorkflow>): LintIssue[] {\n    const issues: LintIssue[] = []\n\n    if (!workflow.nodes) return issues\n\n    // Large workflow warning\n    if (this.isRuleEnabled('perf/large-workflow')) {\n      if (workflow.nodes.length > 50) {\n        issues.push(this.createIssue('perf/large-workflow', 4120, {\n          message: `Large workflow (${workflow.nodes.length} nodes) may be difficult to maintain`,\n          location: { path: 'nodes' }\n        }))\n      }\n    }\n\n    // Calculate total workflow weight\n    if (this.isRuleEnabled('perf/high-weight')) {\n      const totalWeight = workflow.nodes.reduce((sum, node) => sum + (node.weight || 0), 0)\n      const maxWeight = this.config.settings?.rateLimits?.maxWorkflowWeight || 1000\n      const warnThreshold = this.config.settings?.rateLimits?.warnThreshold || 0.8\n\n      if (totalWeight > maxWeight * warnThreshold) {\n        issues.push(this.createIssue('perf/high-weight', 4120, {\n          message: `Total workflow weight (${totalWeight}) approaches rate limit threshold`,\n          location: { path: 'nodes' }\n        }))\n      }\n    }\n\n    return issues\n  }\n\n  /**\n   * Automatically detects required Discord permissions by analyzing workflow graph\n   * This method populates workflow.permissions and node.permissions fields\n   *\n   * @param workflow - The workflow to analyze\n   * @returns Array of validation issues (warnings for unknown actions)\n   */\n  private detectAndValidatePermissions(workflow: AutomaterWorkflow): LintIssue[] {\n    const issues: LintIssue[] = []\n    const requiredPermissions = new Set<string>()\n\n    // 1. Check trigger permissions\n    const triggerEvent = workflow.trigger?.event\n    if (triggerEvent && hasTriggerPermissionMapping(triggerEvent)) {\n      const triggerPerms = TRIGGER_PERMISSION_MAPPINGS[triggerEvent]\n      triggerPerms.forEach(perm => requiredPermissions.add(perm))\n    }\n\n    // 2. Check action permissions for each node in workflow\n    for (const node of workflow.nodes) {\n      if (node.type === 'action' && node.action) {\n        if (hasActionPermissionMapping(node.action)) {\n          const actionPerms = ACTION_PERMISSION_MAPPINGS[node.action]\n          actionPerms.forEach(perm => requiredPermissions.add(perm))\n\n          // Auto-populate node-level permissions for granular tracking\n          node.permissions = actionPerms\n        } else {\n          // Unknown action - add warning if security rules are enabled\n          if (this.isRuleEnabled('security/missing-permissions')) {\n            issues.push(this.createIssue('security/missing-permissions', 3311, {\n              message: `Unknown action '${node.action}' - cannot detect required permissions`,\n              location: { nodeId: node.id },\n              suggestions: [\n                'Check if action is implemented in permission-mappings.ts',\n                'Add permission mapping for this action type'\n              ]\n            }))\n          }\n\n          // Set empty permissions array for unknown actions\n          node.permissions = []\n        }\n      }\n    }\n\n    // 3. Auto-populate workflow-level permissions (union of all node permissions)\n    workflow.permissions = Array.from(requiredPermissions).sort()\n\n    return issues\n  }\n\n  /**\n   * Public API: Detect required permissions for a workflow without mutating it\n   * Returns sorted array of permission flags\n   *\n   * @param workflow - The workflow to analyze\n   * @returns Array of required Discord permission flags (e.g., ['SEND_MESSAGES', 'BAN_MEMBERS'])\n   */\n  public detectRequiredPermissions(workflow: AutomaterWorkflow): string[] {\n    const requiredPermissions = new Set<string>()\n\n    // Check trigger permissions\n    const triggerEvent = workflow.trigger?.event\n    if (triggerEvent && hasTriggerPermissionMapping(triggerEvent)) {\n      const triggerPerms = TRIGGER_PERMISSION_MAPPINGS[triggerEvent]\n      triggerPerms.forEach(perm => requiredPermissions.add(perm))\n    }\n\n    // Check action permissions for each node\n    for (const node of workflow.nodes) {\n      if (node.type === 'action' && node.action) {\n        if (hasActionPermissionMapping(node.action)) {\n          const actionPerms = ACTION_PERMISSION_MAPPINGS[node.action]\n          actionPerms.forEach(perm => requiredPermissions.add(perm))\n        }\n      }\n    }\n\n    // Return sorted array for consistent output\n    return Array.from(requiredPermissions).sort()\n  }\n\n  /**\n   * Public API: Get detailed permission breakdown by node\n   * Useful for debugging and UI displays\n   *\n   * @param workflow - The workflow to analyze\n   * @returns Detailed permission information\n   */\n  public getPermissionBreakdown(workflow: AutomaterWorkflow): {\n    totalPermissions: string[]\n    triggerPermissions: string[]\n    nodePermissions: Map<string, string[]>\n    unknownActions: string[]\n  } {\n    const triggerPermissions: string[] = []\n    const nodePermissions = new Map<string, string[]>()\n    const unknownActions: string[] = []\n\n    // Analyze trigger\n    const triggerEvent = workflow.trigger?.event\n    if (triggerEvent && hasTriggerPermissionMapping(triggerEvent)) {\n      triggerPermissions.push(...TRIGGER_PERMISSION_MAPPINGS[triggerEvent])\n    }\n\n    // Analyze each node\n    for (const node of workflow.nodes) {\n      if (node.type === 'action' && node.action) {\n        if (hasActionPermissionMapping(node.action)) {\n          nodePermissions.set(node.id, ACTION_PERMISSION_MAPPINGS[node.action])\n        } else {\n          unknownActions.push(node.action)\n          nodePermissions.set(node.id, [])\n        }\n      }\n    }\n\n    return {\n      totalPermissions: this.detectRequiredPermissions(workflow),\n      triggerPermissions,\n      nodePermissions,\n      unknownActions\n    }\n  }\n\n  // Helper methods\n  private filterIssues(issues: LintIssue[]): LintIssue[] {\n    return issues.filter(issue => {\n      const ruleConfig = this.config.rules[issue.ruleId]\n      return ruleConfig && ruleConfig !== 'off'\n    })\n  }\n\n  private isRuleEnabled(ruleId: string): boolean {\n    const config = this.config.rules[ruleId]\n    return config && config !== 'off'\n  }\n\n  private createIssue(\n    ruleId: string,\n    errorCode: keyof typeof ERROR_CATALOG,\n    options: {\n      message?: string\n      location?: LintIssue['location']\n      suggestions?: string[]\n    }\n  ): LintIssue {\n    const catalog = ERROR_CATALOG[errorCode]\n\n    return {\n      id: `issue-${this.nextIssueId++}`,\n      ruleId,\n      errorCode: `${catalog.family}-${errorCode}`,\n      family: catalog.family,\n      severity: catalog.severity,\n      message: options.message || catalog.message,\n      remediation: catalog.remediation,\n      location: options.location,\n      suggestions: options.suggestions,\n      fixable: false,\n      timestamp: Date.now()\n    }\n  }\n\n  private createSystemError(error: unknown): LintIssue {\n    return {\n      id: `system-error-${this.nextIssueId++}`,\n      ruleId: 'system/parse-error',\n      errorCode: 'SYS-5510',\n      family: 'SYS',\n      severity: 'error',\n      message: `System error: ${error instanceof Error ? error.message : 'Unknown error'}`,\n      remediation: 'Check workflow structure and try again',\n      fixable: false,\n      timestamp: Date.now()\n    }\n  }\n}\n\n// Legacy class name alias for backward compatibility\nexport { AutoFlowValidator as AutomaterLinter }\n","/**\n * Pack Permission Aggregator\n *\n * Aggregates permissions from multiple automations in a pack.\n * When users install a pack containing multiple workflows, this provides\n * the union of all required permissions across all automations.\n *\n * @module pack-aggregator\n * @packageDocumentation\n */\n\nimport { AutoFlowValidator } from './validator'\nimport type { AutomaterWorkflow } from './validator'\nimport { getPermissionSeverity } from './permission-mappings'\n\n/**\n * Pack interface - represents a collection of related automations\n */\nexport interface AutomaterPack {\n  id: string\n  name: string\n  description?: string\n  version: string\n  author?: string\n  automations: AutomaterWorkflow[]\n  tags?: string[]\n  visibility?: 'public' | 'private' | 'unlisted'\n  createdAt?: string\n  updatedAt?: string\n}\n\n/**\n * Detailed permission summary for a pack\n */\nexport interface PermissionSummary {\n  /**\n   * Union of all permissions required by all automations in the pack\n   */\n  totalPermissions: string[]\n\n  /**\n   * Permissions broken down by automation ID\n   */\n  permissionsByAutomation: Record<string, string[]>\n\n  /**\n   * Permissions used by 2+ automations (shared permissions)\n   */\n  sharedPermissions: string[]\n\n  /**\n   * Permissions used by only 1 automation (unique permissions)\n   * Map of automation ID to array of unique permissions\n   */\n  uniquePermissions: Record<string, string[]>\n\n  /**\n   * Count of automations in the pack\n   */\n  automationCount: number\n\n  /**\n   * Count of total unique permissions\n   */\n  permissionCount: number\n}\n\n/**\n * Pack Permission Aggregator\n *\n * Provides methods to analyze permission requirements across multiple automations\n * in a pack, helping users understand the total permission footprint of a pack.\n */\nexport class PackPermissionAggregator {\n  private validator: AutoFlowValidator\n\n  constructor(validator: AutoFlowValidator) {\n    this.validator = validator\n  }\n\n  /**\n   * Aggregates permissions from all automations in a pack\n   * Returns the union of all required permissions\n   *\n   * @param pack - The pack containing multiple automations\n   * @returns Array of all unique permissions required (sorted alphabetically)\n   *\n   * @example\n   * ```typescript\n   * const aggregator = new PackPermissionAggregator(validator)\n   * const permissions = aggregator.aggregatePackPermissions(moderationPack)\n   * // Returns: ['BAN_MEMBERS', 'KICK_MEMBERS', 'MANAGE_MESSAGES', 'SEND_MESSAGES']\n   * ```\n   */\n  public aggregatePackPermissions(pack: AutomaterPack): string[] {\n    const allPermissions = new Set<string>()\n\n    // Iterate through all automations in the pack\n    for (const automation of pack.automations || []) {\n      const workflowPermissions = this.validator.detectRequiredPermissions(automation)\n      workflowPermissions.forEach(perm => allPermissions.add(perm))\n    }\n\n    // Sort alphabetically for consistent output\n    return Array.from(allPermissions).sort()\n  }\n\n  /**\n   * Generates a detailed permission summary for a pack\n   * Provides breakdown of shared vs unique permissions, useful for pack analysis\n   *\n   * @param pack - The pack to analyze\n   * @returns Detailed permission breakdown\n   *\n   * @example\n   * ```typescript\n   * const summary = aggregator.generatePermissionSummary(moderationPack)\n   * console.log(`Total permissions: ${summary.totalPermissions.length}`)\n   * console.log(`Shared permissions: ${summary.sharedPermissions.join(', ')}`)\n   * ```\n   */\n  public generatePermissionSummary(pack: AutomaterPack): PermissionSummary {\n    const permissionsByAutomation: Record<string, string[]> = {}\n    const permissionUsageCount: Record<string, number> = {}\n\n    // Detect permissions for each automation\n    for (const automation of pack.automations || []) {\n      const perms = this.validator.detectRequiredPermissions(automation)\n      permissionsByAutomation[automation.id] = perms\n\n      // Track usage count\n      perms.forEach(perm => {\n        permissionUsageCount[perm] = (permissionUsageCount[perm] || 0) + 1\n      })\n    }\n\n    // Find shared permissions (used by 2+ automations)\n    const sharedPermissions = Object.entries(permissionUsageCount)\n      .filter(([_, count]) => count > 1)\n      .map(([perm, _]) => perm)\n      .sort()\n\n    // Find unique permissions (used by only 1 automation)\n    const uniquePermissions: Record<string, string[]> = {}\n    for (const [automationId, perms] of Object.entries(permissionsByAutomation)) {\n      uniquePermissions[automationId] = perms.filter(\n        perm => permissionUsageCount[perm] === 1\n      )\n    }\n\n    const totalPermissions = this.aggregatePackPermissions(pack)\n\n    return {\n      totalPermissions,\n      permissionsByAutomation,\n      sharedPermissions,\n      uniquePermissions,\n      automationCount: pack.automations?.length || 0,\n      permissionCount: totalPermissions.length\n    }\n  }\n\n  /**\n   * Compare permission requirements between two packs\n   * Useful for pack version upgrades or alternative pack comparisons\n   *\n   * @param packA - First pack to compare\n   * @param packB - Second pack to compare\n   * @returns Comparison result showing added, removed, and common permissions\n   *\n   * @example\n   * ```typescript\n   * const comparison = aggregator.comparePackPermissions(oldVersion, newVersion)\n   * if (comparison.addedPermissions.length > 0) {\n   *   console.log(`New permissions required: ${comparison.addedPermissions.join(', ')}`)\n   * }\n   * ```\n   */\n  public comparePackPermissions(packA: AutomaterPack, packB: AutomaterPack): {\n    addedPermissions: string[]      // In B but not in A\n    removedPermissions: string[]    // In A but not in B\n    commonPermissions: string[]     // In both A and B\n    packATotal: string[]\n    packBTotal: string[]\n  } {\n    const permsA = new Set(this.aggregatePackPermissions(packA))\n    const permsB = new Set(this.aggregatePackPermissions(packB))\n\n    const addedPermissions = Array.from(permsB).filter(p => !permsA.has(p)).sort()\n    const removedPermissions = Array.from(permsA).filter(p => !permsB.has(p)).sort()\n    const commonPermissions = Array.from(permsA).filter(p => permsB.has(p)).sort()\n\n    return {\n      addedPermissions,\n      removedPermissions,\n      commonPermissions,\n      packATotal: Array.from(permsA).sort(),\n      packBTotal: Array.from(permsB).sort()\n    }\n  }\n\n  /**\n   * Calculates pack permission \"weight\" based on severity\n   * Higher weight = more dangerous permissions\n   *\n   * Scoring:\n   * - Dangerous permission: 10 points (BAN_MEMBERS, KICK_MEMBERS, etc.)\n   * - Moderate permission: 3 points (MANAGE_MESSAGES, MANAGE_CHANNELS, etc.)\n   * - Safe permission: 1 point (SEND_MESSAGES, VIEW_CHANNEL, etc.)\n   *\n   * @param pack - The pack to analyze\n   * @returns Numeric weight score\n   *\n   * @example\n   * ```typescript\n   * const weight = aggregator.calculatePackPermissionWeight(pack)\n   * if (weight > 50) {\n   *   console.warn('This pack requires dangerous permissions')\n   * }\n   * ```\n   */\n  public calculatePackPermissionWeight(pack: AutomaterPack): number {\n    const permissions = this.aggregatePackPermissions(pack)\n\n    let weight = 0\n    for (const perm of permissions) {\n      const severity = getPermissionSeverity(perm)\n      switch (severity) {\n        case 'dangerous':\n          weight += 10\n          break\n        case 'moderate':\n          weight += 3\n          break\n        case 'safe':\n          weight += 1\n          break\n      }\n    }\n\n    return weight\n  }\n\n  /**\n   * Checks if a pack has any dangerous permissions\n   * Returns list of dangerous permissions if found\n   *\n   * @param pack - The pack to check\n   * @returns Array of dangerous permission flags\n   *\n   * @example\n   * ```typescript\n   * const dangerous = aggregator.getDangerousPermissions(pack)\n   * if (dangerous.length > 0) {\n   *   alert(`Warning: This pack requires dangerous permissions: ${dangerous.join(', ')}`)\n   * }\n   * ```\n   */\n  public getDangerousPermissions(pack: AutomaterPack): string[] {\n    const permissions = this.aggregatePackPermissions(pack)\n\n    return permissions.filter(perm =>\n      getPermissionSeverity(perm) === 'dangerous'\n    )\n  }\n}\n","/**\n * React hooks for AutoFlow workflow validation\n *\n * Provides real-time validation integration with ReactFlow\n * CRITICAL: Uses useRef for debounce timers to prevent infinite loops\n */\n\nimport { useCallback, useEffect, useMemo, useState, useRef } from 'react'\nimport { Node, Edge } from 'reactflow'\nimport {\n  AutoFlowValidator,\n  WorkflowLintResult,\n  LintIssue,\n  DEFAULT_LINT_CONFIG,\n  LintConfig,\n  AutomaterWorkflow,\n  WorkflowNode\n} from '../core/validator'\n\nexport interface UseWorkflowLintingOptions {\n  enabled?: boolean\n  debounceMs?: number\n  config?: Partial<LintConfig>\n}\n\nexport interface WorkflowLintingState {\n  result: WorkflowLintResult | null\n  isLinting: boolean\n  lastLintTime: number | null\n  summary: {\n    isValid: boolean\n    message: string\n    canDeploy: boolean\n    total: number\n    errors: number\n    warnings: number\n    infos: number\n    criticals: number\n  }\n  // Quick access arrays\n  issues: LintIssue[]\n  errors: LintIssue[]\n  warnings: LintIssue[]\n  infos: LintIssue[]\n  criticals: LintIssue[]\n  // Methods\n  triggerLint: () => void\n  getNodeIssues: (nodeId: string) => LintIssue[]\n  getEdgeIssues: (edgeId: string) => LintIssue[]\n}\n\n/**\n * Main hook for real-time workflow linting with ReactFlow\n * FIXED: Uses useRef for debounce timer to prevent infinite loops\n */\nexport function useWorkflowLinting(\n  nodes: Node[],\n  edges: Edge[],\n  options: UseWorkflowLintingOptions = {}\n): WorkflowLintingState {\n  const {\n    enabled = true,\n    debounceMs = 500,\n    config = {}\n  } = options\n\n  // State for linting results\n  const [result, setResult] = useState<WorkflowLintResult | null>(null)\n  const [isLinting, setIsLinting] = useState(false)\n  const [lastLintTime, setLastLintTime] = useState<number | null>(null)\n\n  // CRITICAL FIX: Use useRef for debounce timer to prevent re-renders\n  const debounceTimer = useRef<NodeJS.Timeout | null>(null)\n  const validatorRef = useRef<AutoFlowValidator | null>(null)\n\n  // Initialize validator (stable reference)\n  useMemo(() => {\n    validatorRef.current = new AutoFlowValidator({\n      ...DEFAULT_LINT_CONFIG,\n      ...config\n    })\n  }, [config])\n\n  // Core linting function - stable reference\n  const lintWorkflow = useCallback(async (workflowNodes: Node[], workflowEdges: Edge[]) => {\n    if (!enabled || !validatorRef.current) return\n\n    try {\n      setIsLinting(true)\n\n      // Convert React Flow data to workflow format\n      const workflow = createWorkflowFromReactFlow(workflowNodes, workflowEdges)\n\n      // Perform linting\n      const lintResult = await validatorRef.current.validateWorkflow(workflow)\n\n      setResult(lintResult)\n      setLastLintTime(Date.now())\n\n    } catch (error) {\n      console.error('Workflow linting failed:', error)\n      // Set error state\n      setResult({\n        workflowId: 'error',\n        isValid: false,\n        summary: { total: 1, errors: 1, warnings: 0, infos: 0, criticals: 0 },\n        issues: [{\n          id: 'lint-error',\n          ruleId: 'system/lint-error',\n          errorCode: 'SYS-5510',\n          family: 'SYS',\n          severity: 'error',\n          message: `Linting failed: ${error instanceof Error ? error.message : 'Unknown error'}`,\n          remediation: 'Check workflow structure and try again'\n        }],\n        errors: [],\n        warnings: [],\n        infos: [],\n        criticals: [],\n        fixableCount: 0,\n        timestamp: Date.now(),\n        performance: { analysisTime: 0, rulesExecuted: 0 }\n      })\n    } finally {\n      setIsLinting(false)\n    }\n  }, [enabled]) // FIXED: Stable dependency array\n\n  // CRITICAL FIX: Debounced linting with useRef timer\n  const debouncedLint = useCallback((workflowNodes: Node[], workflowEdges: Edge[]) => {\n    // Clear existing timer\n    if (debounceTimer.current) {\n      clearTimeout(debounceTimer.current)\n    }\n\n    // Set new timer\n    debounceTimer.current = setTimeout(() => {\n      lintWorkflow(workflowNodes, workflowEdges)\n    }, debounceMs)\n  }, [lintWorkflow, debounceMs]) // FIXED: Stable dependencies only\n\n  // Manual lint trigger\n  const triggerLint = useCallback(() => {\n    // Clear debounce and lint immediately\n    if (debounceTimer.current) {\n      clearTimeout(debounceTimer.current)\n    }\n    lintWorkflow(nodes, edges)\n  }, [lintWorkflow, nodes, edges])\n\n  // CRITICAL FIX: Effect with stable dependencies\n  useEffect(() => {\n    if (!enabled) {\n      // Clear results when disabled\n      setResult(null)\n      setLastLintTime(null)\n      return\n    }\n\n    if (nodes.length === 0) {\n      // Clear results for empty workflow\n      setResult(null)\n      setLastLintTime(null)\n      return\n    }\n\n    // Trigger debounced linting\n    debouncedLint(nodes, edges)\n\n    // Cleanup function\n    return () => {\n      if (debounceTimer.current) {\n        clearTimeout(debounceTimer.current)\n      }\n    }\n  }, [nodes, edges, enabled, debouncedLint]) // FIXED: Stable dependencies\n\n  // Helper functions for accessing issues\n  const getNodeIssues = useCallback((nodeId: string): LintIssue[] => {\n    if (!result) return []\n    return result.issues.filter(issue => issue.location?.nodeId === nodeId)\n  }, [result])\n\n  const getEdgeIssues = useCallback((edgeId: string): LintIssue[] => {\n    if (!result) return []\n    return result.issues.filter(issue => issue.location?.edgeId === edgeId)\n  }, [result])\n\n  // Computed summary\n  const summary = useMemo(() => {\n    if (!result) {\n      return {\n        isValid: nodes.length === 0,\n        message: nodes.length === 0 ? 'No workflow to validate' : 'Validating...',\n        canDeploy: false,\n        total: 0,\n        errors: 0,\n        warnings: 0,\n        infos: 0,\n        criticals: 0\n      }\n    }\n\n    const { isValid, summary: resultSummary } = result\n\n    if (isValid) {\n      return {\n        isValid: true,\n        message: 'Workflow is valid and ready to deploy',\n        canDeploy: true,\n        ...resultSummary\n      }\n    }\n\n    if (resultSummary.errors > 0 || resultSummary.criticals > 0) {\n      const errorCount = resultSummary.errors + resultSummary.criticals\n      return {\n        isValid: false,\n        message: `${errorCount} error${errorCount === 1 ? '' : 's'} must be fixed before deployment`,\n        canDeploy: false,\n        ...resultSummary\n      }\n    }\n\n    if (resultSummary.warnings > 0) {\n      return {\n        isValid: true,\n        message: `${resultSummary.warnings} warning${resultSummary.warnings === 1 ? '' : 's'} - deployment allowed`,\n        canDeploy: true,\n        ...resultSummary\n      }\n    }\n\n    return {\n      isValid: true,\n      message: 'Workflow is valid',\n      canDeploy: true,\n      ...resultSummary\n    }\n  }, [result, nodes.length])\n\n  return {\n    result,\n    isLinting,\n    lastLintTime,\n    summary,\n    issues: result?.issues || [],\n    errors: result?.errors || [],\n    warnings: result?.warnings || [],\n    infos: result?.infos || [],\n    criticals: result?.criticals || [],\n    triggerLint,\n    getNodeIssues,\n    getEdgeIssues\n  }\n}\n\n/**\n * Hook for node-specific linting state\n * Used to highlight nodes with issues in React Flow\n */\nexport function useNodeLinting(nodeId: string, lintingState: WorkflowLintingState) {\n  return useMemo(() => {\n    const issues = lintingState.getNodeIssues(nodeId)\n\n    const hasErrors = issues.some(issue =>\n      issue.severity === 'error' || issue.severity === 'critical'\n    )\n    const hasWarnings = issues.some(issue => issue.severity === 'warn')\n    const hasIssues = issues.length > 0\n\n    // Determine highest severity\n    let severity: 'error' | 'warn' | 'info' | 'critical' | null = null\n    if (issues.some(i => i.severity === 'critical')) severity = 'critical'\n    else if (issues.some(i => i.severity === 'error')) severity = 'error'\n    else if (issues.some(i => i.severity === 'warn')) severity = 'warn'\n    else if (issues.some(i => i.severity === 'info')) severity = 'info'\n\n    return {\n      hasIssues,\n      hasErrors,\n      hasWarnings,\n      issues,\n      severity,\n      // Quick styling helpers\n      borderColor: severity === 'critical' ? '#dc2626' :\n                  severity === 'error' ? '#ef4444' :\n                  severity === 'warn' ? '#f59e0b' :\n                  severity === 'info' ? '#3b82f6' : undefined,\n      bgColor: severity === 'critical' ? '#dc262610' :\n               severity === 'error' ? '#ef444410' :\n               severity === 'warn' ? '#f59e0b10' :\n               severity === 'info' ? '#3b82f610' : undefined\n    }\n  }, [nodeId, lintingState])\n}\n\n/**\n * Hook for edge-specific linting state\n */\nexport function useEdgeLinting(edgeId: string, lintingState: WorkflowLintingState) {\n  return useMemo(() => {\n    const issues = lintingState.getEdgeIssues(edgeId)\n\n    const hasErrors = issues.some(issue =>\n      issue.severity === 'error' || issue.severity === 'critical'\n    )\n    const hasIssues = issues.length > 0\n\n    // Determine highest severity\n    let severity: 'error' | 'warn' | 'info' | 'critical' | null = null\n    if (issues.some(i => i.severity === 'critical')) severity = 'critical'\n    else if (issues.some(i => i.severity === 'error')) severity = 'error'\n    else if (issues.some(i => i.severity === 'warn')) severity = 'warn'\n    else if (issues.some(i => i.severity === 'info')) severity = 'info'\n\n    return {\n      hasIssues,\n      hasErrors,\n      issues,\n      severity,\n      // Quick styling helpers\n      strokeColor: severity === 'critical' ? '#dc2626' :\n                   severity === 'error' ? '#ef4444' :\n                   severity === 'warn' ? '#f59e0b' :\n                   severity === 'info' ? '#3b82f6' : undefined\n    }\n  }, [edgeId, lintingState])\n}\n\n/**\n * Hook for getting issues grouped by severity\n */\nexport function useGroupedIssues(lintingState: WorkflowLintingState) {\n  return useMemo(() => {\n    const { issues } = lintingState\n\n    return {\n      critical: issues.filter(i => i.severity === 'critical'),\n      error: issues.filter(i => i.severity === 'error'),\n      warning: issues.filter(i => i.severity === 'warn'),\n      info: issues.filter(i => i.severity === 'info'),\n      byNode: issues.reduce((acc, issue) => {\n        const nodeId = issue.location?.nodeId\n        if (nodeId) {\n          if (!acc[nodeId]) acc[nodeId] = []\n          acc[nodeId].push(issue)\n        }\n        return acc\n      }, {} as Record<string, LintIssue[]>)\n    }\n  }, [lintingState.issues])\n}\n\n/**\n * Utility function to convert ReactFlow nodes/edges to workflow format\n */\nexport function createWorkflowFromReactFlow(nodes: Node[], edges: Edge[]): Partial<AutomaterWorkflow> {\n  const workflowNodes: WorkflowNode[] = nodes.map(node => ({\n    id: node.id,\n    type: (node.data?.type || 'action') as WorkflowNode['type'],\n    action: node.data?.action,\n    params: node.data?.params,\n    connections: edges\n      .filter(edge => edge.source === node.id)\n      .map(edge => edge.target),\n    weight: node.data?.weight\n  }))\n\n  return {\n    id: 'temp-workflow',\n    name: 'Temporary Workflow',\n    version: '1.0.0',\n    trigger: { type: 'event', event: 'messageCreate' },\n    nodes: workflowNodes\n  }\n}\n"],"mappings":"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","names":[]}